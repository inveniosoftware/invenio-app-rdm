{#
  Copyright (C) 2020 CERN.
  Copyright (C) 2020 Northwestern University.
  Copyright (C) 2021 TU Wien.
  Copyright (C) 2022 New York University.

  Invenio RDM Records is free software; you can redistribute it and/or modify
  it under the terms of the MIT License; see LICENSE file for more details.
#}

{%- if config.get("APP_RDM_RECORD_EXPORTERS") -%}
{# if no export formats are specified, don't bother showing the box #}
<div class="ui segment rdm-sidebar exports">
  <h2 class="ui small header">{{ _('Export')}}</h2>
  <hr class="thin-line"/>
  <div class="selection-wrap">
    <select class="ui selection dropdown export">
      {# dynamically create the list of export formats #}
      {%- set ns = namespace(initial_val="") %}
      {%- for fmt, val in config.get("APP_RDM_RECORD_EXPORTERS", {}).items() -%}
        {%- set name = val.get("name", fmt) -%}
        {% if is_preview %}
          {%- set export_url = url_for('invenio_app_rdm_records.record_export', pid_value=record.id, export_format=fmt, preview=1) -%}
        {% else %}
          {%- set export_url = url_for('invenio_app_rdm_records.record_export', pid_value=record.id, export_format=fmt) -%}
        {% endif %}

        {% if loop.first %}
          {%- set ns.initial_val = export_url %}
        {% endif %}
         <option value="{{ export_url }}">{{ name }}</option>
      {%- endfor -%}
    </select>
    <a class="ui export button" href="{{ ns.initial_val }}">{{ _('Export')}}</a>
  </div>
</div>
{%- endif -%}
